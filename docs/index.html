<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GanZhi Seasons</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<div id="footer-element-container">
  <div id="element-display">
    <div class="element-circle"></div>
    <div class="element-circle"></div>
  </div>
<div id="seasons-container">Loading…</div>

<script>
const ELEMENT_COLORS = {
  '木': 'green',
  '火': 'red',
  '土': 'yellow',
  '金': 'silver',
  '水': 'blue'
};

fetch('./data.json')
  .then(res => res.json())
  .then(seasons => {
    const today = new Date();
    // Find the latest season whose date is <= today
    let currentSeason = seasons[0];
    for (const s of seasons) {
      const seasonDate = new Date(s.date);
      if (today >= seasonDate) currentSeason = s;
      else break;
    }

    // Update display
    const container = document.getElementById('seasons-container');
    container.innerHTML = '';

    const seasonDiv = document.createElement('div');
    seasonDiv.className = 'season';

    const nameSpan = document.createElement('span');
    nameSpan.className = 'season-name';
    nameSpan.textContent = currentSeason.name + ' (' + currentSeason.solarTerm + ')';
    seasonDiv.appendChild(nameSpan);

    const circlesDiv = document.createElement('div');
    circlesDiv.className = 'element-circles';
    currentSeason.elements.forEach(el => {
      const circle = document.createElement('div');
      circle.className = 'element-circle';
      circle.style.backgroundColor = ELEMENT_COLORS[el] || 'gray';
      circlesDiv.appendChild(circle);
    });

    seasonDiv.appendChild(circlesDiv);
    container.appendChild(seasonDiv);
  })
  .catch(err => console.error(err));
</script>
</body>
</html>