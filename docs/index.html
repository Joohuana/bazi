<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GanZhi Seasons</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<div id="footer-element-container">

<div id="seasons-container">Loading…</div>

<script>
const ELEMENT_COLORS = {
  '木': 'green',
  '火': 'red',
  '土': 'yellow',
  '金': 'silver',
  '水': 'blue'
};

fetch('./data.json')
  .then(res => res.json())
  .then(seasons => {
const today = new Date();
const options = { timeZone: 'Europe/Berlin', year: 'numeric', month: '2-digit', day: '2-digit' };
const berlinDateStr = new Intl.DateTimeFormat('sv', options).format(today);
const [year, month, day] = berlinDateStr.split('-');
const berlinToday = new Date(`${year}-${month}-${day}`);

    let previousElements = ['gray','gray'];
    let currentSeason = seasons[0];

    for (const s of seasons) {
      const seasonDate = new Date(s.date);
      if (today >= seasonDate) {
        currentSeason = s;
        if (s.elements && s.elements.length > 0) {
          previousElements = s.elements;
        }
      } else {
        break;
      }
    }

    const container = document.getElementById('seasons-container');
    container.innerHTML = '';

    const seasonDiv = document.createElement('div');
    seasonDiv.className = 'season';

    // Show only season name like "Spring 1"
    const nameSpan = document.createElement('span');
    nameSpan.className = 'season-name';
    nameSpan.textContent = currentSeason.name;
    seasonDiv.appendChild(nameSpan);

    const circlesDiv = document.createElement('div');
    circlesDiv.className = 'element-circles';

    // Always two circles, use previousElements if empty
    for (let i=0; i<2; i++) {
      const el = previousElements[i] || previousElements[0] || 'gray';
      const circle = document.createElement('div');
      circle.className = 'element-circle';
      circle.style.backgroundColor = ELEMENT_COLORS[el] || 'gray';
      circlesDiv.appendChild(circle);
    }

    seasonDiv.appendChild(circlesDiv);
    container.appendChild(seasonDiv);
  })
  .catch(err => console.error(err));
</script>
</body>
</html>